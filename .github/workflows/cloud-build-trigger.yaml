name: Cloud Build Trigger

on:
  push:
    branches:
      - dev  # Replace with your branch name

jobs:
  trigger-build:
    runs-on: ubuntu-latest

    steps:
      - name: Trigger Cloud Build
        env:
          PROJECT_ID: eastern-concord-396814
          TRIGGER_ID: 8f2f31a4-ebe9-4a64-a93c-7520edd0568c
          ACCESS_TOKEN: ${{ secrets.GCP_SA_KEY }}  # Replace with your GCP service account token
        run: |
          curl -X POST -H "Content-Type: application/json" \
            -H "Authorization: Bearer $ACCESS_TOKEN" \
            -d '{"branchName": "${{ github.ref }}"}' \
            "https://cloudbuild.googleapis.com/v1/projects/$PROJECT_ID/triggers/$TRIGGER_ID:run"
